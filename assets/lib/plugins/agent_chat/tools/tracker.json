{
  "tracker_getGoals": {
    "title": "获取目标列表",
    "description": "获取目标列表,支持按状态和分组筛选,支持分页",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "status": {
            "type": "String",
            "optional": true,
            "description": "目标状态: 'active'(进行中) 或 'completed'(已完成),不传则返回所有目标"
          },
          "group": {
            "type": "String",
            "optional": true,
            "description": "分组名称(如 '学习'、'健康'),用于筛选特定分组的目标"
          },
          "offset": {
            "type": "number",
            "optional": true,
            "description": "分页起始位置（默认 0）"
          },
          "count": {
            "type": "number",
            "optional": true,
            "description": "返回数量（默认 100）"
          }
        }
      }
    ],
    "returns": {
      "type": "Array|Object",
      "description": "无分页参数时返回 Goal 对象数组；有分页参数时返回 {data, total, offset, count, hasMore}"
    },
    "examples": [
      {
        "code": "// 获取所有目标\nconst allGoals = await Memento.plugins.tracker.getGoals({});\nsetResult(allGoals);",
        "comment": "获取所有目标"
      },
      {
        "code": "// 获取进行中的目标\nconst activeGoals = await Memento.plugins.tracker.getGoals({ status: 'active' });\nsetResult(activeGoals);",
        "comment": "筛选活跃目标"
      },
      {
        "code": "// 获取'学习'分组的目标\nconst studyGoals = await Memento.plugins.tracker.getGoals({ group: '学习' });\nsetResult(studyGoals);",
        "comment": "按分组筛选"
      },
      {
        "code": "// 获取'健康'分组中已完成的目标\nconst completedHealthGoals = await Memento.plugins.tracker.getGoals({ status: 'completed', group: '健康' });\nsetResult(completedHealthGoals);",
        "comment": "组合筛选"
      },
      {
        "code": "// 分页获取目标（前20个）\nconst result = await Memento.plugins.tracker.getGoals({ offset: 0, count: 20 });\nsetResult(`共 ${result.total} 个目标，当前返回 ${result.data.length} 个`);",
        "comment": "分页获取目标"
      },
      {
        "code": "// 分页获取学习分组的目标\nconst result = await Memento.plugins.tracker.getGoals({ group: '学习', offset: 0, count: 10 });\nsetResult(`学习分组共 ${result.total} 个目标，当前显示 ${result.data.length} 个，还有更多: ${result.hasMore}`);",
        "comment": "分页获取特定分组的目标"
      }
    ],
    "notes": "返回的 Goal 对象包含: id, name, icon, iconColor, unitType, targetValue, currentValue, dateSettings, reminderTime, isLoopReset, createdAt, group, imagePath, progressColor。使用分页参数可以控制返回数据量，提高性能。推荐每页 20-50 条数据。",
    "enabled": true
  },
  "tracker_getGoal": {
    "title": "获取单个目标",
    "description": "获取单个目标的详细信息",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标的唯一 ID(时间戳字符串)"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "Goal 对象"
    },
    "examples": [
      {
        "code": "const goal = await Memento.plugins.tracker.getGoal({ goalId: 'goal123' });\nconst result = `目标名称: ${goal.name}, 进度: ${goal.currentValue}/${goal.targetValue}`;\nsetResult(result);",
        "comment": "获取目标信息"
      }
    ],
    "notes": "如果目标不存在,会抛出 ArgumentError: Goal not found: <goalId>",
    "enabled": true
  },
  "tracker_createGoal": {
    "title": "创建目标",
    "description": "创建新的追踪目标",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "name": {
            "type": "String",
            "optional": false,
            "description": "目标名称"
          },
          "unitType": {
            "type": "String",
            "optional": false,
            "description": "单位类型(如 '次'、'分钟'、'页'、'公里')"
          },
          "targetValue": {
            "type": "Number",
            "optional": false,
            "description": "目标值(必须大于 0)"
          },
          "id": {
            "type": "String",
            "optional": true,
            "description": "自定义目标 ID,不传则自动生成时间戳 ID。如果提供的 ID 已存在会返回错误"
          },
          "group": {
            "type": "String",
            "optional": true,
            "description": "分组名称,默认为 '默认'"
          },
          "icon": {
            "type": "String",
            "optional": true,
            "description": "图标代码点(Material Icons),默认为 '57455'"
          },
          "dateType": {
            "type": "String",
            "optional": true,
            "description": "日期类型: 'daily'(每日)、'weekly'(每周)、'monthly'(每月)、'custom'(自定义),默认为 'daily'"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "创建的 Goal 对象,包含 id(自定义或自动生成的) 和 createdAt"
    },
    "examples": [
      {
        "code": "// 创建每日阅读目标(自动生成ID)\nconst goal = await Memento.plugins.tracker.createGoal({\n  name: '每日阅读',\n  unitType: '分钟',\n  targetValue: 30,\n  group: '学习'\n});\nsetResult(goal);",
        "comment": "创建每日目标(自动ID)"
      },
      {
        "code": "// 创建每周运动目标(自定义ID)\nconst weeklyGoal = await Memento.plugins.tracker.createGoal({\n  id: 'goal123',\n  name: '每周运动',\n  unitType: '小时',\n  targetValue: 5,\n  group: '健康',\n  dateType: 'weekly'\n});\nsetResult(weeklyGoal);",
        "comment": "创建每周目标(自定义ID)"
      }
    ],
    "notes": "目标创建后 currentValue 初始为 0,isLoopReset 默认为 true。可选传入自定义 id 参数,如果 id 已存在会返回错误信息: {'error': '目标ID已存在: <id>'}",
    "enabled": true
  },
  "tracker_updateGoal": {
    "title": "更新目标",
    "description": "更新目标的属性信息",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标 ID"
          },
          "updateJson": {
            "type": "Object",
            "optional": false,
            "description": "更新数据对象,可包含任意可更新字段"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "更新后的 Goal 对象"
    },
    "examples": [
      {
        "code": "// 更新目标名称和目标值\nconst updated = await Memento.plugins.tracker.updateGoal({\n  goalId: 'goal123',\n  updateJson: {\n    name: '每日深度阅读',\n    targetValue: 60\n  }\n});\nsetResult(updated);",
        "comment": "更新基本信息"
      },
      {
        "code": "// 更新提醒时间和分组\nconst updated2 = await Memento.plugins.tracker.updateGoal({\n  goalId: 'goal123',\n  updateJson: {\n    reminderTime: '20:00',\n    group: '个人成长'\n  }\n});\nsetResult(updated2);",
        "comment": "更新提醒设置"
      }
    ],
    "notes": "可更新字段: name, icon, iconColor, unitType, targetValue, currentValue, dateSettings, reminderTime, isLoopReset, group, imagePath, progressColor",
    "enabled": true
  },
  "tracker_deleteGoal": {
    "title": "删除目标",
    "description": "删除目标及其所有关联记录",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标 ID"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "操作结果对象,成功返回 {success: true, goalId: string},失败返回 {success: false, error: string}"
    },
    "examples": [
      {
        "code": "const result = await Memento.plugins.tracker.deleteGoal({ goalId: 'goal123' });\nif (result.success) {\n  setResult(`成功删除目标: ${result.goalId}`);\n} else {\n  setResult(`删除失败: ${result.error}`);\n}",
        "comment": "删除目标并处理结果"
      }
    ],
    "notes": "删除操作不可逆,会同时删除该目标的所有记录数据。如果goalId不存在或删除过程出错,会返回 {success: false, error: string}",
    "enabled": true
  },
  "tracker_recordData": {
    "title": "添加记录",
    "description": "为目标添加完成记录,自动更新目标进度",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标 ID"
          },
          "value": {
            "type": "Number",
            "optional": false,
            "description": "记录值(必须为正数)"
          },
          "id": {
            "type": "String",
            "optional": true,
            "description": "自定义记录 ID,不传则自动生成时间戳 ID。如果提供的 ID 已存在会返回错误"
          },
          "note": {
            "type": "String",
            "optional": true,
            "description": "备注信息"
          },
          "dateTime": {
            "type": "String",
            "optional": true,
            "description": "记录时间(ISO 8601 格式),默认为当前时间"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "创建的 Record 对象,包含 id(自定义或自动生成的), goalId, value, note, recordedAt, durationSeconds"
    },
    "examples": [
      {
        "code": "// 添加今日阅读记录(自动生成ID)\nconst record = await Memento.plugins.tracker.recordData({\n  goalId: 'goal123',\n  value: 30,\n  note: '阅读《代码整洁之道》'\n});\nsetResult(record);",
        "comment": "添加当前记录(自动ID)"
      },
      {
        "code": "// 添加昨日的记录\nconst yesterday = await Memento.system.getCustomDate({subtract: {days: 1}, relativePosition: 'startOfDay', format: 'iso'});\nconst pastTime = yesterday.replace(/T.*/, 'T20:00:00.000Z');\nconst pastRecord = await Memento.plugins.tracker.recordData({\n  goalId: 'goal123',\n  value: 45,\n  note: '昨日补记',\n  dateTime: pastTime\n});\nsetResult(pastRecord);",
        "comment": "补记历史数据(自动ID)"
      },
      {
        "code": "// 使用自定义ID添加记录\nconst customRecord = await Memento.plugins.tracker.recordData({\n  id: 'record123',\n  goalId: 'goal123',\n  value: 25,\n  note: '晨读'\n});\nsetResult(customRecord);",
        "comment": "使用自定义ID"
      }
    ],
    "notes": "记录会自动累加到目标的 currentValue,并触发 onRecordAdded 事件供其他插件监听。可选传入自定义 id 参数,如果 id 已存在会返回错误信息: {'error': '记录ID已存在: <id>'}",
    "enabled": true
  },
  "tracker_getRecords": {
    "title": "获取记录列表",
    "description": "获取目标的记录历史,按时间倒序排列,支持分页",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标 ID"
          },
          "limit": {
            "type": "Number",
            "optional": true,
            "description": "返回的最大记录数,不传则返回所有记录（已弃用，建议使用 count）"
          },
          "offset": {
            "type": "number",
            "optional": true,
            "description": "分页起始位置（默认 0）"
          },
          "count": {
            "type": "number",
            "optional": true,
            "description": "返回数量（默认 100）"
          }
        }
      }
    ],
    "returns": {
      "type": "Array|Object",
      "description": "无分页参数时返回 Record 对象数组；有分页参数时返回 {data, total, offset, count, hasMore}"
    },
    "examples": [
      {
        "code": "// 获取所有记录\nconst allRecords = await Memento.plugins.tracker.getRecords({ goalId: 'goal123' });\nsetResult(allRecords);",
        "comment": "获取全部记录"
      },
      {
        "code": "// 获取最近 10 条记录（使用 limit）\nconst recentRecords = await Memento.plugins.tracker.getRecords({ goalId: 'goal123', limit: 10 });\nconst result = recentRecords.map(record => `${record.recordedAt}: ${record.value} ${record.note || ''}`).join('\\n');\nsetResult(result);",
        "comment": "使用 limit 获取最新记录"
      },
      {
        "code": "// 分页获取记录（前20条）\nconst result = await Memento.plugins.tracker.getRecords({ goalId: 'goal123', offset: 0, count: 20 });\nsetResult(`共 ${result.total} 条记录，当前返回 ${result.data.length} 条`);",
        "comment": "分页获取记录"
      },
      {
        "code": "// 分页获取记录（第二页）\nconst result = await Memento.plugins.tracker.getRecords({ goalId: 'goal123', offset: 20, count: 20 });\nsetResult(`还有更多记录: ${result.hasMore}，当前返回 ${result.count} 条`);",
        "comment": "获取下一页记录"
      }
    ],
    "notes": "返回的 Record 对象包含: id, goalId, value, note, recordedAt, durationSeconds(可选)。使用分页参数可以控制返回数据量，提高性能。推荐每页 20-50 条数据。",
    "enabled": true
  },
  "tracker_deleteRecord": {
    "title": "删除记录",
    "description": "删除单条记录,自动从目标进度中扣除对应值",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "recordId": {
            "type": "String",
            "optional": false,
            "description": "记录 ID"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "操作结果对象,成功返回 {success: true, recordId: string},失败返回 {success: false, error: string}"
    },
    "examples": [
      {
        "code": "const result = await Memento.plugins.tracker.deleteRecord({ recordId: 'record123' });\nif (result.success) {\n  setResult(`成功删除记录: ${result.recordId}`);\n} else {\n  setResult(`删除失败: ${result.error}`);\n}",
        "comment": "删除记录并处理结果"
      }
    ],
    "notes": "删除记录会自动从目标的 currentValue 中减去对应的 value 值。如果recordId不存在或删除过程出错,会返回 {success: false, error: string}",
    "enabled": true
  },
  "tracker_getProgress": {
    "title": "获取进度信息",
    "description": "获取目标的当前进度详情",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": false,
            "description": "目标 ID"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "进度信息对象,包含 goalId, currentValue, targetValue, progress, percentage, isCompleted"
    },
    "examples": [
      {
        "code": "const progress = await Memento.plugins.tracker.getProgress({ goalId: 'goal123' });\nconst result = `进度: ${progress.percentage}%\\n完成状态: ${progress.isCompleted ? '已完成' : '进行中'}`;\nsetResult(result);",
        "comment": "查询目标进度"
      }
    ],
    "notes": "progress 为小数(0-1),percentage 为百分比字符串,isCompleted 表示是否达到目标值",
    "enabled": true
  },
  "tracker_getStats": {
    "title": "获取统计信息",
    "description": "获取全局或单个目标的统计数据",
    "parameters": [
      {
        "name": "params",
        "type": "Object",
        "optional": false,
        "description": "参数对象",
        "properties": {
          "goalId": {
            "type": "String",
            "optional": true,
            "description": "目标 ID,不传则返回全局统计"
          }
        }
      }
    ],
    "returns": {
      "type": "Object",
      "description": "统计信息对象,全局统计和单目标统计返回格式不同"
    },
    "examples": [
      {
        "code": "// 获取全局统计\nconst stats = await Memento.plugins.tracker.getStats({});\nconst result = `总目标数: ${stats.totalGoals}\\n今日完成: ${stats.todayCompleted}\\n本月完成: ${stats.monthCompleted}\\n整体进度: ${(stats.overallProgress * 100).toFixed(1)}%\\n分组列表: ${stats.groups.join(', ')}`;\nsetResult(result);",
        "comment": "全局统计"
      },
      {
        "code": "// 获取单个目标统计\nconst goalStats = await Memento.plugins.tracker.getStats({ goalId: 'goal123' });\nconst result = `目标名称: ${goalStats.goalName}\\n总记录数: ${goalStats.totalRecords}\\n累计值: ${goalStats.totalValue}`;\nsetResult(result);",
        "comment": "单目标统计"
      }
    ],
    "notes": "全局统计包含: totalGoals, todayCompleted, monthCompleted, monthAdded, todayRecords, overallProgress, groups。单目标统计包含: goalId, goalName, totalRecords, totalValue, currentValue, targetValue, progress, isCompleted",
    "enabled": true
  },
  "tracker_findGoalBy": {
    "title": "通用目标查找",
    "description": "根据自定义条件查找目标（支持单条/多条结果）",
    "parameters": [
      {"name": "field", "type": "string", "required": true, "description": "要匹配的字段名（如：id、name、group、unitType）"},
      {"name": "value", "type": "any", "required": true, "description": "要匹配的值"},
      {"name": "findAll", "type": "boolean", "required": false, "description": "是否返回所有匹配项（默认 false，只返回第一个）"}
    ],
    "returns": {
      "type": "Object|Array|null",
      "description": "findAll=false 时返回单个目标对象或 null；findAll=true 时返回目标数组"
    },
    "examples": [
      {
        "title": "根据 ID 查找目标",
        "code": "const goal = await Memento.plugins.tracker.findGoalBy({field: 'id', value: 'goal123'});\nif (goal) {\n  setResult(`找到目标: ${goal.name}，进度: ${goal.currentValue}/${goal.targetValue}`);\n} else {\n  setResult('未找到该目标');\n}"
      },
      {
        "title": "查找所有学习分组的目标",
        "code": "const goals = await Memento.plugins.tracker.findGoalBy({field: 'group', value: '学习', findAll: true});\nsetResult(`学习分组有 ${goals.length} 个目标`);"
      }
    ],
    "notes": "简化查找逻辑，避免手动遍历目标列表；支持任意字段匹配",
    "enabled": true
  },
  "tracker_findGoalById": {
    "title": "根据ID查找目标",
    "description": "快速根据目标ID查找单个目标（findGoalBy 的便捷方法）",
    "parameters": [
      {"name": "id", "type": "string", "required": true, "description": "目标ID"}
    ],
    "returns": {
      "type": "Object|null",
      "description": "找到的目标对象，未找到返回 null"
    },
    "examples": [
      {
        "title": "查找指定ID的目标",
        "code": "const goal = await Memento.plugins.tracker.findGoalById({id: 'goal123'});\nif (goal) {\n  setResult(`目标名称: ${goal.name}, 单位: ${goal.unitType}, 进度: ${goal.currentValue}/${goal.targetValue}`);\n} else {\n  setResult('目标不存在');\n}"
      }
    ],
    "notes": "等价于 getGoal 或 findGoalBy({field: 'id', value: id})",
    "enabled": true
  },
  "tracker_findGoalByName": {
    "title": "根据名称查找目标",
    "description": "根据目标名称查找目标（支持精确匹配或模糊匹配）",
    "parameters": [
      {"name": "name", "type": "string", "required": true, "description": "目标名称"},
      {"name": "fuzzy", "type": "boolean", "required": false, "description": "是否模糊匹配（默认 false，精确匹配）"},
      {"name": "findAll", "type": "boolean", "required": false, "description": "是否返回所有匹配项（默认 false）"}
    ],
    "returns": {
      "type": "Object|Array|null",
      "description": "findAll=false 时返回单个目标或 null；findAll=true 时返回目标数组"
    },
    "examples": [
      {
        "title": "精确匹配目标名称",
        "code": "const goal = await Memento.plugins.tracker.findGoalByName({name: '每日阅读'});\nsetResult(goal ? `目标ID: ${goal.id}` : '未找到');"
      },
      {
        "title": "模糊匹配查找所有包含关键词的目标",
        "code": "const goals = await Memento.plugins.tracker.findGoalByName({name: '阅读', fuzzy: true, findAll: true});\nconst totalProgress = goals.reduce((sum, g) => sum + (g.currentValue || 0), 0);\nsetResult(`找到 ${goals.length} 个阅读相关目标，总进度: ${totalProgress}`);"
      }
    ],
    "notes": "精确匹配使用 ===，模糊匹配使用 includes",
    "enabled": true
  },
  "tracker_findGoalsByGroup": {
    "title": "根据分组查找目标",
    "description": "查找指定分组的所有目标",
    "parameters": [
      {"name": "group", "type": "string", "required": true, "description": "分组名称"},
      {"name": "status", "type": "string", "required": false, "description": "可选的状态过滤: 'active' | 'completed'"}
    ],
    "returns": {
      "type": "Array",
      "description": "该分组的目标列表"
    },
    "examples": [
      {
        "title": "查找学习分组的所有目标",
        "code": "const goals = await Memento.plugins.tracker.findGoalsByGroup({group: '学习'});\nsetResult(`学习分组有 ${goals.length} 个目标`);"
      },
      {
        "title": "查找健康分组的活跃目标",
        "code": "const goals = await Memento.plugins.tracker.findGoalsByGroup({group: '健康', status: 'active'});\nconst avgProgress = goals.reduce((sum, g) => sum + (g.currentValue / g.targetValue), 0) / goals.length;\nsetResult(`健康分组有 ${goals.length} 个活跃目标，平均进度: ${(avgProgress * 100).toFixed(1)}%`);"
      }
    ],
    "notes": "等价于 getGoals({group}) 但更语义化；支持额外的状态过滤",
    "enabled": true
  },
  "tracker_findRecordBy": {
    "title": "通用记录查找",
    "description": "根据自定义条件查找记录（支持单条/多条结果）",
    "parameters": [
      {"name": "field", "type": "string", "required": true, "description": "要匹配的字段名（如：id、goalId、value、note）"},
      {"name": "value", "type": "any", "required": true, "description": "要匹配的值"},
      {"name": "goalId", "type": "string", "required": false, "description": "限定在特定目标内查找（可选）"},
      {"name": "findAll", "type": "boolean", "required": false, "description": "是否返回所有匹配项（默认 false）"}
    ],
    "returns": {
      "type": "Object|Array|null",
      "description": "findAll=false 时返回单个记录或 null；findAll=true 时返回记录数组"
    },
    "examples": [
      {
        "title": "根据 ID 查找记录",
        "code": "const record = await Memento.plugins.tracker.findRecordBy({field: 'id', value: 'record123'});\nif (record) {\n  setResult(`记录值: ${record.value}, 备注: ${record.note || '无'}`);\n} else {\n  setResult('未找到该记录');\n}"
      },
      {
        "title": "查找特定目标的所有大于30的记录",
        "code": "const allRecords = await Memento.plugins.tracker.getRecords({goalId: 'goal123'});\nconst largeRecords = allRecords.filter(r => r.value > 30);\nsetResult(`找到 ${largeRecords.length} 条大于30的记录`);"
      }
    ],
    "notes": "简化查找逻辑；goalId 可选，不传则在所有目标的记录中查找",
    "enabled": true
  },
  "tracker_findRecordById": {
    "title": "根据ID查找记录",
    "description": "快速根据记录ID查找单个记录（findRecordBy 的便捷方法）",
    "parameters": [
      {"name": "id", "type": "string", "required": true, "description": "记录ID"},
      {"name": "goalId", "type": "string", "required": false, "description": "限定在特定目标内查找（可选，提高性能）"}
    ],
    "returns": {
      "type": "Object|null",
      "description": "找到的记录对象，未找到返回 null"
    },
    "examples": [
      {
        "title": "查找指定ID的记录",
        "code": "const record = await Memento.plugins.tracker.findRecordById({id: 'record123'});\nif (record) {\n  setResult(`记录值: ${record.value}, 时间: ${record.recordedAt}, 备注: ${record.note || '无'}`);\n} else {\n  setResult('记录不存在');\n}"
      }
    ],
    "notes": "等价于 findRecordBy({field: 'id', value: id, goalId})",
    "enabled": true
  }
}
