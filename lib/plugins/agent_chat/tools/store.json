{
  "store_getProducts": {
    "title": "获取商品列表",
    "description": "获取所有可兑换的商品列表",
    "parameters": [],
    "returns": {
      "type": "String",
      "description": "Product 对象数组的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const products = await window.plugins.store.getProducts();\nconsole.log('商品列表:', JSON.parse(products));",
        "comment": "获取所有商品"
      }
    ],
    "notes": "返回的 Product 对象包含: id, name, description, image, stock, price, exchange_start, exchange_end, use_duration",
    "enabled": true
  },
  "store_getProduct": {
    "title": "获取商品详情",
    "description": "获取单个商品的详细信息",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "商品 ID"
      }
    ],
    "returns": {
      "type": "String",
      "description": "Product 对象的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const product = await window.plugins.store.getProduct('1731473170123');\nconsole.log('商品详情:', JSON.parse(product));",
        "comment": "获取指定商品信息"
      }
    ],
    "notes": "如果商品不存在会抛出异常",
    "enabled": true
  },
  "store_createProduct": {
    "title": "创建商品",
    "description": "添加新的虚拟商品到商店",
    "parameters": [
      {
        "name": "name",
        "type": "String",
        "optional": false,
        "description": "商品名称"
      },
      {
        "name": "description",
        "type": "String",
        "optional": false,
        "description": "商品描述"
      },
      {
        "name": "price",
        "type": "Number",
        "optional": false,
        "description": "价格(积分)"
      },
      {
        "name": "stock",
        "type": "Number",
        "optional": false,
        "description": "库存数量"
      },
      {
        "name": "exchangeStart",
        "type": "String",
        "optional": false,
        "description": "兑换开始时间(ISO 8601 格式)"
      },
      {
        "name": "exchangeEnd",
        "type": "String",
        "optional": false,
        "description": "兑换结束时间(ISO 8601 格式)"
      },
      {
        "name": "useDuration",
        "type": "Number",
        "optional": false,
        "description": "使用期限(天数)"
      },
      {
        "name": "image",
        "type": "String",
        "optional": true,
        "description": "商品图片路径"
      }
    ],
    "returns": {
      "type": "String",
      "description": "创建的 Product 对象的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const newProduct = await window.plugins.store.createProduct(\n  '迟到豁免卡',\n  '可豁免一次迟到',\n  30,\n  20,\n  '2025-01-01T00:00:00.000Z',\n  '2025-12-31T23:59:59.999Z',\n  60,\n  'assets/late_pass.png'\n);\nconsole.log('创建成功:', JSON.parse(newProduct));",
        "comment": "创建新商品"
      }
    ],
    "notes": "创建后自动分配唯一 ID(时间戳字符串)",
    "enabled": true
  },
  "store_updateProduct": {
    "title": "更新商品",
    "description": "更新商品的信息",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "商品 ID"
      },
      {
        "name": "name",
        "type": "String",
        "optional": false,
        "description": "商品名称"
      },
      {
        "name": "description",
        "type": "String",
        "optional": false,
        "description": "商品描述"
      },
      {
        "name": "price",
        "type": "Number",
        "optional": false,
        "description": "价格(积分)"
      },
      {
        "name": "stock",
        "type": "Number",
        "optional": false,
        "description": "库存数量"
      },
      {
        "name": "exchangeStart",
        "type": "String",
        "optional": false,
        "description": "兑换开始时间(ISO 8601 格式)"
      },
      {
        "name": "exchangeEnd",
        "type": "String",
        "optional": false,
        "description": "兑换结束时间(ISO 8601 格式)"
      },
      {
        "name": "useDuration",
        "type": "Number",
        "optional": false,
        "description": "使用期限(天数)"
      },
      {
        "name": "image",
        "type": "String",
        "optional": true,
        "description": "商品图片路径"
      }
    ],
    "returns": {
      "type": "String",
      "description": "更新后的 Product 对象的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const updated = await window.plugins.store.updateProduct(\n  '1731473170123',\n  '免作业卡(升级版)',\n  '可免除两次作业',\n  100,\n  5,\n  '2025-01-01T00:00:00.000Z',\n  '2025-12-31T23:59:59.999Z',\n  60\n);\nconsole.log('更新成功:', JSON.parse(updated));",
        "comment": "更新商品信息"
      }
    ],
    "notes": "如果商品不存在会抛出异常,已兑换的用户物品不受影响(使用快照机制)",
    "enabled": true
  },
  "store_deleteProduct": {
    "title": "删除商品",
    "description": "归档商品(软删除),可通过 restoreProduct 恢复",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "商品 ID"
      }
    ],
    "returns": {
      "type": "Boolean",
      "description": "总是返回 true"
    },
    "examples": [
      {
        "code": "await window.plugins.store.deleteProduct('1731473170123');\nconsole.log('商品已归档');",
        "comment": "归档商品"
      }
    ],
    "notes": "商品会被移到归档列表而不是物理删除,可通过 restoreProduct 恢复",
    "enabled": true
  },
  "store_redeem": {
    "title": "兑换商品",
    "description": "使用积分兑换商品,生成用户物品",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "商品 ID"
      }
    ],
    "returns": {
      "type": "String",
      "description": "兑换结果的 JSON 字符串,包含 success, message, currentPoints"
    },
    "examples": [
      {
        "code": "const result = await window.plugins.store.redeem('1731473170123');\nconst data = JSON.parse(result);\nif (data.success) {\n  console.log('兑换成功!剩余积分:', data.currentPoints);\n} else {\n  console.log('兑换失败:', data.message);\n}",
        "comment": "兑换商品"
      }
    ],
    "notes": "兑换失败的可能原因: 积分不足、库存不足、不在兑换期内。成功后会扣除积分、减少库存、生成用户物品并记录积分日志",
    "enabled": true
  },
  "store_getPoints": {
    "title": "获取当前积分",
    "description": "查询用户的当前积分余额",
    "parameters": [],
    "returns": {
      "type": "Number",
      "description": "当前积分值"
    },
    "examples": [
      {
        "code": "const points = await window.plugins.store.getPoints();\nconsole.log('当前积分:', points);",
        "comment": "查询积分余额"
      }
    ],
    "notes": "积分可通过应用内行为自动获得或手动添加",
    "enabled": true
  },
  "store_addPoints": {
    "title": "添加/扣除积分",
    "description": "手动增加或减少用户积分",
    "parameters": [
      {
        "name": "points",
        "type": "Number",
        "optional": false,
        "description": "积分值(正数增加,负数减少)"
      },
      {
        "name": "reason",
        "type": "String",
        "optional": false,
        "description": "变动原因描述"
      }
    ],
    "returns": {
      "type": "String",
      "description": "操作结果的 JSON 字符串,包含 success, currentPoints, message"
    },
    "examples": [
      {
        "code": "// 增加积分\nconst result1 = await window.plugins.store.addPoints(50, '完成任务奖励');\nconsole.log('增加成功:', JSON.parse(result1));",
        "comment": "增加积分"
      },
      {
        "code": "// 扣除积分\nconst result2 = await window.plugins.store.addPoints(-20, '购买道具');\nconsole.log('扣除成功:', JSON.parse(result2));",
        "comment": "扣除积分"
      }
    ],
    "notes": "会自动记录积分日志,包含类型(获得/消耗)、值、原因和时间",
    "enabled": true
  },
  "store_getRedeemHistory": {
    "title": "获取兑换历史",
    "description": "获取用户的所有兑换记录",
    "parameters": [],
    "returns": {
      "type": "String",
      "description": "UserItem 对象数组的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const history = await window.plugins.store.getRedeemHistory();\nconsole.log('兑换历史:', JSON.parse(history));",
        "comment": "查询兑换记录"
      }
    ],
    "notes": "返回的 UserItem 包含: id, product_id, remaining, expire_date, purchase_date, purchase_price, product_snapshot(商品快照)",
    "enabled": true
  },
  "store_getPointsHistory": {
    "title": "获取积分历史",
    "description": "获取所有积分变动记录",
    "parameters": [],
    "returns": {
      "type": "String",
      "description": "PointsLog 对象数组的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const logs = await window.plugins.store.getPointsHistory();\nconsole.log('积分历史:', JSON.parse(logs));",
        "comment": "查询积分记录"
      }
    ],
    "notes": "返回的 PointsLog 包含: id, type(获得/消耗), value, reason, timestamp",
    "enabled": true
  },
  "store_getUserItems": {
    "title": "获取用户物品",
    "description": "获取用户拥有的所有物品",
    "parameters": [],
    "returns": {
      "type": "String",
      "description": "UserItem 对象数组的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const items = await window.plugins.store.getUserItems();\nconsole.log('我的物品:', JSON.parse(items));",
        "comment": "查询拥有的物品"
      }
    ],
    "notes": "仅返回未过期且剩余次数大于 0 的物品",
    "enabled": true
  },
  "store_useItem": {
    "title": "使用物品",
    "description": "使用用户物品,减少剩余次数",
    "parameters": [
      {
        "name": "itemId",
        "type": "String",
        "optional": false,
        "description": "物品 ID"
      }
    ],
    "returns": {
      "type": "String",
      "description": "使用结果的 JSON 字符串,包含 success, message"
    },
    "examples": [
      {
        "code": "const result = await window.plugins.store.useItem('1731473170456');\nconst data = JSON.parse(result);\nif (data.success) {\n  console.log('使用成功');\n} else {\n  console.log('使用失败:', data.message);\n}",
        "comment": "使用物品"
      }
    ],
    "notes": "使用后剩余次数减 1,次数归零后物品自动移除,过期物品无法使用。使用记录会保存到 used_items.json",
    "enabled": true
  },
  "store_archiveProduct": {
    "title": "归档商品",
    "description": "将商品移至归档列表(软删除)",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "商品 ID"
      }
    ],
    "returns": {
      "type": "Boolean",
      "description": "总是返回 true"
    },
    "examples": [
      {
        "code": "await window.plugins.store.archiveProduct('1731473170123');\nconsole.log('商品已归档');",
        "comment": "归档商品"
      }
    ],
    "notes": "与 deleteProduct 功能相同,归档的商品可通过 restoreProduct 恢复",
    "enabled": true
  },
  "store_restoreProduct": {
    "title": "恢复商品",
    "description": "从归档列表恢复商品",
    "parameters": [
      {
        "name": "productId",
        "type": "String",
        "optional": false,
        "description": "归档商品 ID"
      }
    ],
    "returns": {
      "type": "Boolean",
      "description": "总是返回 true"
    },
    "examples": [
      {
        "code": "await window.plugins.store.restoreProduct('1731473170123');\nconsole.log('商品已恢复');",
        "comment": "恢复归档商品"
      }
    ],
    "notes": "如果归档商品不存在会抛出异常",
    "enabled": true
  },
  "store_getArchivedProducts": {
    "title": "获取归档商品",
    "description": "获取所有已归档的商品列表",
    "parameters": [],
    "returns": {
      "type": "String",
      "description": "Product 对象数组的 JSON 字符串"
    },
    "examples": [
      {
        "code": "const archived = await window.plugins.store.getArchivedProducts();\nconsole.log('归档商品:', JSON.parse(archived));",
        "comment": "查询归档商品"
      }
    ],
    "notes": "归档商品不会在普通商品列表中显示",
    "enabled": true
  }
}
