<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memento Sync Server - Admin</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js?v=3.4.0"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>Memento Sync Server</h1>
                <div class="header-actions" v-if="isLoggedIn">
                    <span class="user-info">{{ currentUser }}</span>
                    <button class="btn btn-outline" @click="logout">ÈÄÄÂá∫ÁôªÂΩï</button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Login Form -->
            <div v-if="!isLoggedIn" class="login-container">
                <div class="card login-card">
                    <h2>ÁÆ°ÁêÜÂëòÁôªÂΩï</h2>
                    <div class="login-tips">
                        <small>ÈªòËÆ§Âá≠ÊçÆ: admin / admin123</small>
                    </div>
                    <form @submit.prevent="login">
                        <div class="form-group">
                            <label for="username">Áî®Êà∑Âêç</label>
                            <input
                                type="text"
                                id="username"
                                v-model="loginForm.username"
                                required
                                placeholder="ËØ∑ËæìÂÖ•Áî®Êà∑Âêç"
                            >
                        </div>
                        <div class="form-group">
                            <label for="password">ÂØÜÁ†Å</label>
                            <input
                                type="password"
                                id="password"
                                v-model="loginForm.password"
                                required
                                placeholder="ËØ∑ËæìÂÖ•ÂØÜÁ†Å"
                            >
                        </div>
                        <div class="form-group">
                            <label for="server">ÊúçÂä°Âô®Âú∞ÂùÄ</label>
                            <input
                                type="url"
                                id="server"
                                v-model="serverUrl"
                                required
                                placeholder="http://localhost:8080"
                            >
                        </div>
                        <button type="submit" class="btn btn-primary btn-block" :disabled="loading">
                            {{ loading ? 'ÁôªÂΩï‰∏≠...' : 'ÁôªÂΩï' }}
                        </button>
                        <p v-if="error" class="error-message">{{ error }}</p>
                    </form>
                </div>
            </div>

            <!-- Dashboard -->
            <div v-else class="dashboard">
                <!-- Tabs -->
                <div class="tabs">
                    <button
                        class="tab"
                        :class="{ active: activeTab === 'overview' }"
                        @click="activeTab = 'overview'"
                    >
                        Ê¶ÇËßà
                    </button>
                    <button
                        class="tab"
                        :class="{ active: activeTab === 'files' }"
                        @click="activeTab = 'files'"
                    >
                        Êñá‰ª∂ÁÆ°ÁêÜ
                    </button>
                    <button
                        class="tab"
                        :class="{ active: activeTab === 'settings' }"
                        @click="activeTab = 'settings'"
                    >
                        Êìç‰Ωú
                    </button>
                </div>

                <!-- Overview Tab -->
                <div v-show="activeTab === 'overview'" class="tab-content">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üìÅ</div>
                            <div class="stat-info">
                                <div class="stat-value">{{ stats.totalFiles }}</div>
                                <div class="stat-label">ÂêåÊ≠•Êñá‰ª∂Êï∞</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üíæ</div>
                            <div class="stat-info">
                                <div class="stat-value">{{ formatSize(stats.totalSize) }}</div>
                                <div class="stat-label">ÊÄªÂ≠òÂÇ®Â§ßÂ∞è</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <div class="stat-info">
                                <div class="stat-value" :class="{ 'text-green': serverStatus === 'online' }">
                                    {{ serverStatus === 'online' ? 'Âú®Á∫ø' : 'Á¶ªÁ∫ø' }}
                                </div>
                                <div class="stat-label">ÊúçÂä°Âô®Áä∂ÊÄÅ</div>
                            </div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="card">
                        <h3>ÊúÄËøëÊ¥ªÂä®</h3>
                        <div class="activity-list">
                            <div v-for="activity in recentActivities" :key="activity.id" class="activity-item">
                                <span class="activity-icon">{{ getActivityIcon(activity.type) }}</span>
                                <span class="activity-text">{{ activity.message }}</span>
                                <span class="activity-time">{{ formatTime(activity.time) }}</span>
                            </div>
                            <div v-if="recentActivities.length === 0" class="empty-message">
                                ÊöÇÊó†Ê¥ªÂä®ËÆ∞ÂΩï
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Files Tab -->
                <div v-show="activeTab === 'files'" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>Êñá‰ª∂ÁÆ°ÁêÜ</h3>
                            <button class="btn btn-primary" @click="refreshFiles">
                                üîÑ Âà∑Êñ∞
                            </button>
                        </div>

                        <!-- Ê†ëÂΩ¢ËßÜÂõæ -->
                        <div class="directory-tree">
                            <template v-if="directoryTree">
                                <tree-node
                                    :node="directoryTree"
                                    :level="0"
                                    :expanded-folders="expandedFolders"
                                    @toggle="toggleFolder"
                                    @download="downloadFile"
                                    @delete="deleteFile"
                                />
                            </template>
                            <template v-else>
                                <div class="empty-message">
                                    ÊöÇÊó†ÂêåÊ≠•Êñá‰ª∂
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- Settings Tab -->
                <div v-show="activeTab === 'settings'" class="tab-content">
                    <div class="card">
                        <h3>Êï∞ÊçÆÊìç‰Ωú</h3>
                        <div class="action-buttons">
                            <button class="btn btn-outline" @click="exportData">
                                üì§ ÂØºÂá∫Êï∞ÊçÆ
                            </button>
                            <button class="btn btn-danger" @click="clearServerData">
                                üóëÔ∏è Ê∏ÖÁ©∫ÊúçÂä°Âô®Êï∞ÊçÆ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Toast Notifications -->
        <div class="toast-container">
            <div
                v-for="toast in toasts"
                :key="toast.id"
                class="toast"
                :class="toast.type"
            >
                {{ toast.message }}
            </div>
        </div>

        <!-- Loading Overlay -->
        <div v-if="loading" class="loading-overlay">
            <div class="spinner"></div>
            <span>{{ loadingMessage }}</span>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
