# Windows TTS å®Œå…¨æŒ‡å—

## ğŸ“‹ ç›®å½•
- [ç³»ç»Ÿè¦æ±‚](#ç³»ç»Ÿè¦æ±‚)
- [å®‰è£…è¯­éŸ³åŒ…](#å®‰è£…è¯­éŸ³åŒ…)
- [éªŒè¯å®‰è£…](#éªŒè¯å®‰è£…)
- [åº”ç”¨é…ç½®](#åº”ç”¨é…ç½®)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [å¯ç”¨è¯­éŸ³åˆ—è¡¨](#å¯ç”¨è¯­éŸ³åˆ—è¡¨)

---

## ğŸ¯ ç³»ç»Ÿè¦æ±‚

- **æ“ä½œç³»ç»Ÿ**: Windows 10 (1803+) æˆ– Windows 11
- **Flutter**: 3.7.0+
- **flutter_tts**: 3.8.0+

---

## ğŸ“¦ å®‰è£…è¯­éŸ³åŒ…

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ Windows è®¾ç½®ï¼ˆæ¨èï¼‰

#### Windows 10

1. **æ‰“å¼€è®¾ç½®**
   ```
   Win + I â†’ æ—¶é—´å’Œè¯­è¨€ â†’ è¯­éŸ³
   ```

2. **ç®¡ç†è¯­éŸ³**
   - ç‚¹å‡»"ç®¡ç†è¯­éŸ³"
   - ç‚¹å‡»"æ·»åŠ è¯­éŸ³"
   - é€‰æ‹©éœ€è¦çš„è¯­è¨€

3. **ä¸‹è½½è¯­éŸ³ç»„ä»¶**
   - é€‰æ‹©è¯­è¨€åç‚¹å‡»"é€‰é¡¹"
   - å‹¾é€‰å¹¶ä¸‹è½½"è¯­éŸ³"ç»„ä»¶
   - ç­‰å¾…ä¸‹è½½å®Œæˆ

#### Windows 11

1. **æ‰“å¼€è®¾ç½®**
   ```
   Win + I â†’ æ—¶é—´å’Œè¯­è¨€ â†’ è¯­è¨€å’ŒåŒºåŸŸ
   ```

2. **æ·»åŠ è¯­è¨€**
   - ç‚¹å‡»"æ·»åŠ è¯­è¨€"
   - æœç´¢è¯­è¨€ï¼ˆå¦‚"ä¸­æ–‡ï¼ˆç®€ä½“ï¼Œä¸­å›½ï¼‰"ï¼‰
   - å‹¾é€‰"è¯­éŸ³"é€‰é¡¹
   - ç‚¹å‡»å®‰è£…

3. **ç­‰å¾…å®‰è£…**
   - ç³»ç»Ÿè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…è¯­éŸ³åŒ…

### æ–¹æ³•äºŒï¼šé€šè¿‡è®²è¿°äºº

1. **å¿«æ·é”®å¯åŠ¨**
   ```
   Win + Ctrl + N
   ```

2. **æ·»åŠ è¯­éŸ³**
   - åœ¨è®²è¿°äººè®¾ç½®ä¸­
   - ç‚¹å‡»"æ·»åŠ ä¼ ç»Ÿè¯­éŸ³"
   - è·³è½¬åˆ°è¯­éŸ³è®¾ç½®é¡µé¢
   - æŒ‰ç…§æ–¹æ³•ä¸€ç»§ç»­

---

## âœ… éªŒè¯å®‰è£…

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ç³»ç»Ÿè®¾ç½®

1. **æ‰“å¼€æ§åˆ¶é¢æ¿**
   ```
   æ§åˆ¶é¢æ¿ â†’ è¯­éŸ³è¯†åˆ« â†’ æ–‡æœ¬åˆ°è¯­éŸ³è½¬æ¢
   ```

2. **æŸ¥çœ‹è¯­éŸ³é€‰æ‹©**
   - ä¸‹æ‹‰èœå•æ˜¾ç¤ºå·²å®‰è£…çš„è¯­éŸ³
   - é€‰æ‹©è¯­éŸ³åç‚¹å‡»"é¢„è§ˆè¯­éŸ³"æµ‹è¯•

### æ–¹æ³•äºŒï¼šé€šè¿‡ PowerShell

```powershell
# åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„è¯­éŸ³
Add-Type -AssemblyName System.Speech
$synth = New-Object System.Speech.Synthesis.SpeechSynthesizer
$synth.GetInstalledVoices() | ForEach-Object {
    $_.VoiceInfo | Select-Object Name, Culture, Gender
}
```

### æ–¹æ³•ä¸‰ï¼šé€šè¿‡ Memento åº”ç”¨

1. **è¿è¡Œåº”ç”¨**
   ```bash
   flutter run -d windows
   ```

2. **æŸ¥çœ‹æ—¥å¿—**
   - åº”ç”¨å¯åŠ¨æ—¶ä¼šè¾“å‡ºï¼š
   ```
   [INFO] Windows å¯ç”¨è¯­éŸ³æ•°é‡: X
   [INFO] è¯­éŸ³ 0: name=Microsoft Huihui, locale=zh-CN, gender=Female
   [INFO] è¯­éŸ³ 1: name=Microsoft Zira, locale=en-US, gender=Female
   ```

3. **åœ¨åº”ç”¨ä¸­æµ‹è¯•**
   - æ‰“å¼€ TTS æ’ä»¶
   - åˆ›å»º/ç¼–è¾‘æœåŠ¡
   - æŸ¥çœ‹è¯­éŸ³ä¸‹æ‹‰åˆ—è¡¨

---

## âš™ï¸ åº”ç”¨é…ç½®

### åˆ›å»º Windows TTS æœåŠ¡

1. **æ‰“å¼€ TTS æ’ä»¶**
   - åœ¨ Memento ä¸»ç•Œé¢ç‚¹å‡»"è¯­éŸ³æœ—è¯»"æ’ä»¶

2. **æ·»åŠ æ–°æœåŠ¡**
   - ç‚¹å‡»å³ä¸‹è§’ â• æŒ‰é’®
   - æˆ–ç‚¹å‡»"æ·»åŠ æœåŠ¡"

3. **é…ç½®å‚æ•°**
   ```
   æœåŠ¡åç§°: Windows ä¸­æ–‡è¯­éŸ³
   æœåŠ¡ç±»å‹: ç³»ç»ŸTTS âœ“
   å¯ç”¨: âœ“
   é»˜è®¤æœåŠ¡: âœ“

   æœ—è¯»å‚æ•°:
   - éŸ³è°ƒ: 1.0
   - è¯­é€Ÿ: 1.0
   - éŸ³é‡: 1.0
   - è¯­éŸ³: Microsoft Huihui (ä»åˆ—è¡¨é€‰æ‹©)
   ```

4. **æµ‹è¯•è¯­éŸ³**
   - ä¿å­˜åç‚¹å‡»èœå•ä¸­çš„"æµ‹è¯•"
   - åº”è¯¥èƒ½å¬åˆ°"ä½ å¥½ï¼Œè¿™æ˜¯è¯­éŸ³æµ‹è¯•"

### é…ç½®å¤šä¸ªè¯­éŸ³

ä½ å¯ä»¥åˆ›å»ºå¤šä¸ªæœåŠ¡é…ç½®ä¸åŒçš„è¯­éŸ³ï¼š

```
æœåŠ¡ 1: Windows ä¸­æ–‡å¥³å£° (Huihui)
æœåŠ¡ 2: Windows è‹±æ–‡å¥³å£° (Zira)
æœåŠ¡ 3: Windows ä¸­æ–‡ç”·å£° (Kangkang)
```

---

## ğŸ› å¸¸è§é—®é¢˜

### Q1: æ²¡æœ‰æ£€æµ‹åˆ°å¯ç”¨è¯­éŸ³

**ç—‡çŠ¶:**
```
[WARNING] Windows æœªæ£€æµ‹åˆ°å¯ç”¨è¯­éŸ³ï¼Œè¯·å®‰è£… Windows è¯­éŸ³åŒ…
```

**è§£å†³æ–¹æ¡ˆ:**
1. æŒ‰ç…§[å®‰è£…è¯­éŸ³åŒ…](#å®‰è£…è¯­éŸ³åŒ…)é‡æ–°å®‰è£…
2. é‡å¯åº”ç”¨
3. å¦‚æœä»ç„¶ä¸è¡Œï¼Œé‡å¯ç³»ç»Ÿ

### Q2: è¯­éŸ³åˆ—è¡¨ä¸ºç©º

**å¯èƒ½åŸå› :**
- è¯­éŸ³åŒ…æœªå®Œå…¨ä¸‹è½½
- Windows æœåŠ¡æœªå¯åŠ¨

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥è¯­éŸ³åŒ…å®‰è£…çŠ¶æ€
   ```
   è®¾ç½® â†’ æ—¶é—´å’Œè¯­è¨€ â†’ è¯­è¨€ â†’ æ£€æŸ¥æ›´æ–°
   ```

2. é‡å¯ Windows Speech Runtime æœåŠ¡
   ```powershell
   # ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ PowerShell
   Restart-Service -Name "WSearch"
   ```

### Q3: æœ—è¯»æ²¡æœ‰å£°éŸ³

**æ’æŸ¥æ­¥éª¤:**

1. **æ£€æŸ¥ç³»ç»ŸéŸ³é‡**
   - ç¡®ä¿ç³»ç»ŸéŸ³é‡æœªé™éŸ³
   - è°ƒæ•´éŸ³é‡åˆ° 50% ä»¥ä¸Š

2. **æ£€æŸ¥åº”ç”¨é…ç½®**
   - éŸ³é‡å‚æ•°æ˜¯å¦ä¸º 0
   - æœåŠ¡æ˜¯å¦å¯ç”¨

3. **æµ‹è¯•ç³»ç»Ÿ TTS**
   ```
   æ§åˆ¶é¢æ¿ â†’ è¯­éŸ³è¯†åˆ« â†’ æ–‡æœ¬åˆ°è¯­éŸ³è½¬æ¢ â†’ é¢„è§ˆè¯­éŸ³
   ```

4. **æŸ¥çœ‹åº”ç”¨æ—¥å¿—**
   ```
   [INFO] æœ—è¯»è¯·æ±‚å·²å‘é€
   [INFO] å¼€å§‹æœ—è¯»
   [INFO] æœ—è¯»å®Œæˆ
   ```

### Q4: è¯­éŸ³å¬èµ·æ¥å¾ˆå¥‡æ€ª

**å¯èƒ½åŸå› :**
- éŸ³è°ƒæˆ–è¯­é€Ÿè®¾ç½®ä¸å½“
- ä½¿ç”¨äº†ä¸åŒ¹é…çš„è¯­éŸ³ï¼ˆå¦‚ä¸­æ–‡æ–‡æœ¬ç”¨è‹±æ–‡è¯­éŸ³ï¼‰

**è§£å†³æ–¹æ¡ˆ:**
1. é‡ç½®å‚æ•°ä¸ºé»˜è®¤å€¼
   - éŸ³è°ƒ: 1.0
   - è¯­é€Ÿ: 1.0
   - éŸ³é‡: 1.0

2. é€‰æ‹©åŒ¹é…çš„è¯­éŸ³
   - ä¸­æ–‡æ–‡æœ¬ â†’ ä¸­æ–‡è¯­éŸ³
   - è‹±æ–‡æ–‡æœ¬ â†’ è‹±æ–‡è¯­éŸ³

### Q5: åˆ‡æ¢è¯­éŸ³æ— æ•ˆ

**åŸå› :**
- Windows å¹³å°éœ€è¦ä½¿ç”¨ `setVoice` è€Œé `setLanguage`

**å·²åœ¨ä»£ç ä¸­ä¿®å¤:**
```dart
if (Platform.isWindows) {
  await _flutterTts.setVoice({'name': voiceName, 'locale': locale});
}
```

---

## ğŸ“‹ å¯ç”¨è¯­éŸ³åˆ—è¡¨

### Windows 10/11 å†…ç½®è¯­éŸ³

#### ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰
| è¯­éŸ³åç§° | ID | æ€§åˆ« | å¤‡æ³¨ |
|---------|-----|------|------|
| Microsoft Huihui | Microsoft Huihui Desktop | å¥³ | é»˜è®¤ä¸­æ–‡è¯­éŸ³ |
| Microsoft Kangkang | Microsoft Kangkang | ç”· | éšè—è¯­éŸ³ |
| Microsoft Yaoyao | Microsoft Yaoyao | å¥³ | éšè—è¯­éŸ³ |

#### è‹±è¯­ï¼ˆç¾å›½ï¼‰
| è¯­éŸ³åç§° | ID | æ€§åˆ« | å¤‡æ³¨ |
|---------|-----|------|------|
| Microsoft Zira | Microsoft Zira Desktop | å¥³ | é»˜è®¤è‹±æ–‡è¯­éŸ³ |
| Microsoft David | Microsoft David Desktop | ç”· | éœ€é¢å¤–å®‰è£… |
| Microsoft Mark | Microsoft Mark | ç”· | éœ€é¢å¤–å®‰è£… |

#### å…¶ä»–è¯­è¨€
- æ—¥è¯­ï¼šMicrosoft Haruka
- éŸ©è¯­ï¼šMicrosoft Heami
- æ³•è¯­ï¼šMicrosoft Hortense
- å¾·è¯­ï¼šMicrosoft Hedda
- è¥¿ç­ç‰™è¯­ï¼šMicrosoft Helena

> æ³¨æ„ï¼šéƒ¨åˆ†è¯­éŸ³éœ€è¦å®‰è£…å¯¹åº”çš„è¯­è¨€åŒ…

### è·å–å®Œæ•´åˆ—è¡¨

åœ¨åº”ç”¨å¯åŠ¨æ—¶æŸ¥çœ‹æ—¥å¿—ï¼š
```
[INFO] Windows å¯ç”¨è¯­éŸ³æ•°é‡: 5
[INFO] è¯­éŸ³ 0: name=Microsoft Huihui Desktop, locale=zh-CN, gender=Female
[INFO] è¯­éŸ³ 1: name=Microsoft Zira Desktop, locale=en-US, gender=Female
...
```

---

## ğŸ”¬ é«˜çº§é…ç½®

### å¯ç”¨éšè—è¯­éŸ³ï¼ˆåº·åº·ã€ç‘¶ç‘¶ï¼‰

è¿™äº›è¯­éŸ³å·²å®‰è£…ä½†é»˜è®¤ä¸æ˜¾ç¤ºï¼Œéœ€è¦ä¿®æ”¹æ³¨å†Œè¡¨ï¼š

1. **æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨**
   ```
   Win + R â†’ regedit
   ```

2. **å¯¼èˆªåˆ°è¯­éŸ³è·¯å¾„**
   ```
   HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Speech\Voices\Tokens
   ```

3. **æŸ¥æ‰¾è¯­éŸ³é¡¹**
   - æ‰¾åˆ° `MS-CHS-Kangkang-11.0`
   - æ‰¾åˆ° `MS-CHS-Yaoyao-11.0`

4. **åˆ›å»ºå±æ€§**
   - å³é”® â†’ æ–°å»º â†’ å­—ç¬¦ä¸²å€¼
   - åç§°ï¼š`CLSID`
   - å€¼ï¼š`{D5A60F70-3E00-11D2-96CB-0060B0576642}`

5. **é‡å¯ç³»ç»Ÿ**

> âš ï¸ è­¦å‘Šï¼šä¿®æ”¹æ³¨å†Œè¡¨æœ‰é£é™©ï¼Œå»ºè®®å…ˆå¤‡ä»½

### è°ƒæ•´è¯­éŸ³è´¨é‡

æŸäº›è¯­éŸ³æ”¯æŒè´¨é‡è®¾ç½®ï¼š

```dart
// åœ¨ä»£ç ä¸­æ·»åŠ ï¼ˆéœ€è¦ä¿®æ”¹ flutter_tts æ’ä»¶ï¼‰
await flutterTts.setVoice({
  'name': 'Microsoft Huihui Desktop',
  'locale': 'zh-CN',
  'quality': 'high'  // low, medium, high
});
```

---

## ğŸ“š å‚è€ƒèµ„æº

- [Microsoft Speech Platform](https://www.microsoft.com/en-us/download/details.aspx?id=27225)
- [Windows TTS API æ–‡æ¡£](https://learn.microsoft.com/en-us/windows/apps/develop/speech)
- [flutter_tts æ–‡æ¡£](https://pub.dev/packages/flutter_tts)
- [Memento é¡¹ç›®](https://github.com/hunmer/Memento)

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ–¹æ³•éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼š

1. **æŸ¥çœ‹åº”ç”¨æ—¥å¿—**
   - è¿è¡Œåº”ç”¨æ—¶æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º
   - æŸ¥æ‰¾ `[ERROR]` æˆ– `[WARNING]` æ ‡è®°

2. **æäº¤ Issue**
   - å‰å¾€ [GitHub Issues](https://github.com/hunmer/Memento/issues)
   - æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œæ—¥å¿—

3. **ç¤¾åŒºè®¨è®º**
   - åœ¨é¡¹ç›® Discussions ä¸­å‘å¸–
   - å…¶ä»–ç”¨æˆ·å¯èƒ½é‡åˆ°ç›¸åŒé—®é¢˜

---

**æœ€åæ›´æ–°**: 2025-01-19
**é€‚ç”¨ç‰ˆæœ¬**: Memento 1.1.7+
